{"remainingRequest":"E:\\shixi\\TechHome-master\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\shixi\\TechHome-master\\src\\views\\flat\\installation\\work-order-inquiry\\manual-judgment-red-yellow-orders.vue?vue&type=script&lang=js","dependencies":[{"path":"E:\\shixi\\TechHome-master\\src\\views\\flat\\installation\\work-order-inquiry\\manual-judgment-red-yellow-orders.vue","mtime":1770455485000},{"path":"E:\\shixi\\TechHome-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1770598777886},{"path":"E:\\shixi\\TechHome-master\\node_modules\\babel-loader\\lib\\index.js","mtime":1770598779870},{"path":"E:\\shixi\\TechHome-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1770598777886},{"path":"E:\\shixi\\TechHome-master\\node_modules\\vue-loader\\lib\\index.js","mtime":1770598780759}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGZldGNoTGlzdE1hbnVhbEp1ZGdtZW50UmVkWWVsbG93T3JkZXJzLCBleHBvcnRMaXN0TWFudWFsSnVkZ21lbnRSZWRZZWxsb3dPcmRlcnMgfSBmcm9tICdAL2FwaS9pbnN0YWxsYXRpb24nCmltcG9ydCB3YXZlcyBmcm9tICdAL2RpcmVjdGl2ZS93YXZlcycgLy8gd2F2ZXMgZGlyZWN0aXZlCmltcG9ydCBQYWdpbmF0aW9uIGZyb20gJ0AvY29tcG9uZW50cy9QYWdpbmF0aW9uJyAvLyBzZWNvbmRhcnkgcGFja2FnZSBiYXNlZCBvbiBlbC1wYWdpbmF0aW9uCgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ0luc3RhbGxhdGlvbk1hbnVhbEp1ZGdtZW50UmVkWWVsbG93T3JkZXJzJywKICBjb21wb25lbnRzOiB7IFBhZ2luYXRpb24gfSwKICBkaXJlY3RpdmVzOiB7IHdhdmVzIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHRhYmxlS2V5OiAwLAogICAgICBsaXN0OiBudWxsLAogICAgICB0b3RhbDogMCwKICAgICAgbGlzdExvYWRpbmc6IHRydWUsCiAgICAgIGxpc3RRdWVyeTogewogICAgICAgIHBhZ2U6IDEsCiAgICAgICAgbGltaXQ6IDUwLAogICAgICAgIGNvdW50eV9uYW1lOiB1bmRlZmluZWQsCiAgICAgICAgZm9ybV9ubzogdW5kZWZpbmVkLAogICAgICAgIGZvcm1fdGl0bGU6IHVuZGVmaW5lZCwKICAgICAgICBicm9hZGJhbmRfYWNjb3VudDogdW5kZWZpbmVkLAogICAgICAgIGZsb3dfbmFtZTogdW5kZWZpbmVkLAogICAgICAgIHNlbmRfdGltZTogdW5kZWZpbmVkCiAgICAgIH0sCiAgICAgIGZpbHRlckNvbmZpZzogWwogICAgICAgIHsga2V5OiAnY291bnR5X25hbWUnLCBwbGFjZWhvbGRlcjogJ+WMuuWOvycsIHR5cGU6ICdpbnB1dCcgfSwKICAgICAgICB7IGtleTogJ2Zvcm1fbm8nLCBwbGFjZWhvbGRlcjogJ+W3peWNlee8luWPtycsIHR5cGU6ICdpbnB1dCcgfSwKICAgICAgICB7IGtleTogJ2Zvcm1fdGl0bGUnLCBwbGFjZWhvbGRlcjogJ+W3peWNleagh+mimCcsIHR5cGU6ICdpbnB1dCcgfSwKICAgICAgICB7IGtleTogJ2Jyb2FkYmFuZF9hY2NvdW50JywgcGxhY2Vob2xkZXI6ICflrr3luKbotKblj7cnLCB0eXBlOiAnaW5wdXQnIH0sCiAgICAgICAgeyBrZXk6ICdmbG93X25hbWUnLCBwbGFjZWhvbGRlcjogJ+a1geeoi+WQjeensCcsIHR5cGU6ICdtdWx0aXBsZV9zZWxlY3QnLCBvcHRpb25zOiBbeyBsYWJlbDogJ+aJi+WGmeWIpOaWrea1geeoiycsIHZhbHVlOiAn5omL5YaZ5Yik5pat5rWB56iLJyB9LCB7IGxhYmVsOiAn5Zyw5Z2A5bu66K6+5rWB56iLJywgdmFsdWU6ICflnLDlnYDlu7rorr7mtYHnqIsnIH0sIHsgbGFiZWw6ICfliIblhYnlmajmianlrrnmtYHnqIsnLCB2YWx1ZTogJ+WIhuWFieWZqOaJqeWuuea1geeoiycgfV0gfSwKICAgICAgICB7IGtleTogJ3NlbmRfdGltZScsIHN0YXJ0OiAn5rS+5Y2V5byA5aeL5pe26Ze0JywgZW5kOiAn5rS+5Y2V57uT5p2f5pe26Ze0JywgdHlwZTogJ2RhdGUnIH0KICAgICAgXSwKICAgICAgdGFibGVDb2x1bW5zOiBbCiAgICAgICAgeyBwcm9wOiAnY291bnR5X25hbWUnLCBsYWJlbDogJ+WMuuWOvycsIHdpZHRoOiAnMTEwJywgYWxpZ246ICdjZW50ZXInIH0sCiAgICAgICAgeyBwcm9wOiAnZm9ybV9ubycsIGxhYmVsOiAn5bel5Y2V57yW5Y+3Jywgd2lkdGg6ICcxNjAnLCBhbGlnbjogJ2NlbnRlcicgfSwKICAgICAgICB7IHByb3A6ICdmb3JtX3RpdGxlJywgbGFiZWw6ICflt6XljZXmoIfpopgnLCBtaW5XaWR0aDogJzE1MCcsIGFsaWduOiAnY2VudGVyJyB9LAogICAgICAgIHsgcHJvcDogJ2N1cnJlbnRfc3RhdGUnLCBsYWJlbDogJ+W3peWNleeKtuaAgScsIHdpZHRoOiAnMTAwJywgYWxpZ246ICdjZW50ZXInLCB0eXBlOiAnc3RhdHVzJyB9LAogICAgICAgIHsgcHJvcDogJ2Jyb2FkYmFuZF9hY2NvdW50JywgbGFiZWw6ICflrr3luKbotKblj7cnLCB3aWR0aDogJzEyMCcsIGFsaWduOiAnY2VudGVyJyB9LAogICAgICAgIHsgcHJvcDogJ2Zsb3dfbmFtZScsIGxhYmVsOiAn5rWB56iL5ZCN56ewJywgd2lkdGg6ICcxMzAnLCBhbGlnbjogJ2NlbnRlcicgfSwKICAgICAgICB7IHByb3A6ICdzZW5kX3RpbWUnLCBsYWJlbDogJ+a0vuWNleaXtumXtCcsIHdpZHRoOiAnMTYwJywgYWxpZ246ICdjZW50ZXInLCB0eXBlOiAnZGF0ZXRpbWUnIH0KICAgICAgXSwKICAgICAgc3RhdHVzTWFwOiB7CiAgICAgICAgJzInOiAn6L+Q6KGM5LitJywKICAgICAgICAnMyc6ICflt7LlvZLmoaMnCiAgICAgIH0KICAgIH0KICB9LAogIGNyZWF0ZWQoKSB7CiAgICAvLyBDaGVjayBmb3IgY3Jvc3MtcGFnZSBzZWFyY2ggZmlsdGVycyBpbiBWdWV4CiAgICBjb25zdCBpbml0aWFsRmlsdGVycyA9IHRoaXMuJHN0b3JlLnN0YXRlLmNyb3NzUGFnZVNlYXJjaC5pbml0aWFsRmlsdGVycwogICAgaWYgKGluaXRpYWxGaWx0ZXJzKSB7CiAgICAgIC8vIE1lcmdlIHRoZSBmaWx0ZXJzIGludG8gdGhlIGxvY2FsIHF1ZXJ5IG9iamVjdAogICAgICB0aGlzLmxpc3RRdWVyeSA9IHsgLi4udGhpcy5saXN0UXVlcnksIC4uLmluaXRpYWxGaWx0ZXJzIH0KICAgICAgLy8gQ2xlYXIgdGhlIGZpbHRlcnMgaW4gVnVleCBzbyB0aGV5IGFyZSBub3QgdXNlZCBhZ2FpbgogICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ2Nyb3NzUGFnZVNlYXJjaC9DTEVBUl9JTklUSUFMX0ZJTFRFUlMnKQogICAgfQogICAgdGhpcy5nZXRMaXN0KCkKICB9LAogIG1ldGhvZHM6IHsKICAgIGdldExpc3QoKSB7CiAgICAgIHRoaXMubGlzdExvYWRpbmcgPSB0cnVlCiAgICAgIGZldGNoTGlzdE1hbnVhbEp1ZGdtZW50UmVkWWVsbG93T3JkZXJzKHRoaXMubGlzdFF1ZXJ5KS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICB0aGlzLmxpc3QgPSByZXNwb25zZS5kYXRhLml0ZW1zCiAgICAgICAgdGhpcy50b3RhbCA9IHJlc3BvbnNlLmRhdGEudG90YWwKICAgICAgICB0aGlzLmxpc3RMb2FkaW5nID0gZmFsc2UKICAgICAgfSkKICAgIH0sCiAgICBoYW5kbGVGaWx0ZXIoKSB7CiAgICAgIHRoaXMubGlzdFF1ZXJ5LnBhZ2UgPSAxCiAgICAgIHRoaXMuZ2V0TGlzdCgpCiAgICB9LAogICAgYXN5bmMgaGFuZGxlRG93bmxvYWQoKSB7CiAgICAgIGNvbnN0IHsgc2VuZF90aW1lIH0gPSB0aGlzLmxpc3RRdWVyeQogICAgICBpZiAoIXNlbmRfdGltZSkgewogICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+W/hemhu+mAieaLqea0vuWNleaXtumXtCcpCiAgICAgICAgcmV0dXJuCiAgICAgIH0KCiAgICAgIGNvbnN0IHN0YXJ0RGF0ZSA9IG5ldyBEYXRlKHNlbmRfdGltZVswXSkKICAgICAgY29uc3QgZW5kRGF0ZSA9IG5ldyBEYXRlKHNlbmRfdGltZVsxXSkKICAgICAgY29uc3QgdGltZURpZmYgPSBlbmREYXRlLmdldFRpbWUoKSAtIHN0YXJ0RGF0ZS5nZXRUaW1lKCkKICAgICAgY29uc3QgZGF5RGlmZiA9IHRpbWVEaWZmIC8gKDEwMDAgKiAzNjAwICogMjQpCgogICAgICBpZiAoZGF5RGlmZiA+IDQwKSB7CiAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcign5a+85Ye6RXhjZWzml7bvvIzmnJ/mnJsm5pyA5ZCO6aKE57qm5pe26Ze05pyA5aSn6Leo5bqm5Li6NDDlpKknKQogICAgICAgIHJldHVybgogICAgICB9CgogICAgICB0aGlzLmRvd25sb2FkTG9hZGluZyA9IHRydWUKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCBxdWVyeUZvckFsbCA9IHsgLi4udGhpcy5saXN0UXVlcnkgfQogICAgICAgIGRlbGV0ZSBxdWVyeUZvckFsbC5wYWdlCiAgICAgICAgZGVsZXRlIHF1ZXJ5Rm9yQWxsLmxpbWl0CgogICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZXhwb3J0TGlzdE1hbnVhbEp1ZGdtZW50UmVkWWVsbG93T3JkZXJzKHF1ZXJ5Rm9yQWxsKQogICAgICAgIGNvbnN0IGFsbERhdGEgPSByZXNwb25zZS5kYXRhCgogICAgICAgIGlmICghYWxsRGF0YSB8fCBhbGxEYXRhLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgdGhpcy4kbWVzc2FnZS53YXJuaW5nKCfmsqHmnInlj6/lr7zlh7rnmoTmlbDmja4nKQogICAgICAgICAgcmV0dXJuIC8vIEV4aXQgaWYgdGhlcmUncyBubyBkYXRhIHRvIGV4cG9ydAogICAgICAgIH0KCiAgICAgICAgaW1wb3J0KCdAL3ZlbmRvci9FeHBvcnQyRXhjZWwnKS50aGVuKGV4Y2VsID0+IHsKICAgICAgICAgIGNvbnN0IHRIZWFkZXIgPSBbJ+WMuuWOvycsICflt6XljZXnvJblj7cnLCAn5bel5Y2V5qCH6aKYJywgJ+WuveW4pui0puWPtycsICfmtYHnqIvlkI3np7AnLCAn5rS+5Y2V5byA5aeL5pe26Ze0J10KICAgICAgICAgIGNvbnN0IGZpbHRlclZhbCA9IFsnY291bnR5X25hbWUnLCAnZm9ybV9ubycsICdmb3JtX3RpdGxlJywgJ2Jyb2FkYmFuZF9hY2NvdW50JywgJ2Zsb3dfbmFtZScsICdzZW5kX3RpbWUnXQogICAgICAgICAgY29uc3QgZGF0YSA9IHRoaXMuZm9ybWF0SnNvbihmaWx0ZXJWYWwsIGFsbERhdGEpCiAgICAgICAgICBleGNlbC5leHBvcnRfanNvbl90b19leGNlbCh7CiAgICAgICAgICAgIGhlYWRlcjogdEhlYWRlciwKICAgICAgICAgICAgZGF0YSwKICAgICAgICAgICAgZmlsZW5hbWU6IGDmiYvlhpnliKTmlq0v57qi6buE5Y2VLSR7bmV3IERhdGUoKS50b0xvY2FsZVN0cmluZygpfWAsCiAgICAgICAgICAgIGF1dG9XaWR0aDogdHJ1ZSwKICAgICAgICAgICAgYm9va1R5cGU6ICd4bHN4JwogICAgICAgICAgfSkKICAgICAgICB9KQogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUuZXJyb3IoJ+WvvOWHukV4Y2Vs5pe25Y+R55Sf6ZSZ6K+vOicsIGVycm9yKQogICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+WvvOWHuuWksei0pe+8jOivt+eojeWQjumHjeivlScpCiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgdGhpcy5kb3dubG9hZExvYWRpbmcgPSBmYWxzZQogICAgICB9CiAgICB9LAogICAgZm9ybWF0SnNvbihmaWx0ZXJWYWwsIGpzb25EYXRhKSB7CiAgICAgIHJldHVybiBqc29uRGF0YS5tYXAodiA9PiBmaWx0ZXJWYWwubWFwKGogPT4gewogICAgICAgIGlmIChqID09PSAnY3VycmVudF9zdGF0ZScpIHsKICAgICAgICAgIHJldHVybiB0aGlzLnN0YXR1c01hcFt2W2pdXQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXR1cm4gdltqXQogICAgICAgIH0KICAgICAgfSkpCiAgICB9CgogIH0KfQo="},{"version":3,"sources":["manual-judgment-red-yellow-orders.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoFA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA","file":"manual-judgment-red-yellow-orders.vue","sourceRoot":"src/views/flat/installation/work-order-inquiry","sourcesContent":["<template>\n  <div class=\"app-container\">\n    <div class=\"filter-container\">\n      <template v-for=\"item in filterConfig\">\n        <el-input\n          v-if=\"item.type === 'input'\"\n          :key=\"item.key\"\n          v-model=\"listQuery[item.key]\"\n          :placeholder=\"item.placeholder\"\n          style=\"width: 120px; margin-right: 8px;\"\n          clearable\n          class=\"filter-item\"\n        />\n        <el-date-picker\n          v-else-if=\"item.type === 'date'\"\n          :key=\"item.key\"\n          v-model=\"listQuery[item.key]\"\n          type=\"datetimerange\"\n          value-format=\"yyyy-MM-dd HH:mm:ss\"\n          range-separator=\"至\"\n          :start-placeholder=\"item.start\"\n          :end-placeholder=\"item.end\"\n          class=\"filter-item\"\n          style=\"margin-right: 8px;\"\n          clearable\n        />\n        <el-select\n          v-else-if=\"item.type === 'multiple_select'\"\n          :key=\"item.key\"\n          v-model=\"listQuery[item.key]\"\n          :placeholder=\"item.placeholder\"\n          clearable\n          multiple\n          collapse-tags\n          class=\"filter-item\"\n          style=\"width: 200px; margin-right: 8px;\"\n        >\n          <el-option\n            v-for=\"option in item.options\"\n            :key=\"option.value\"\n            :label=\"option.label\"\n            :value=\"option.value\"\n          />\n        </el-select>\n      </template>\n      <el-button v-waves class=\"filter-item\" type=\"primary\" icon=\"el-icon-search\" @click=\"handleFilter\">\n        搜索\n      </el-button>\n      <el-button :loading=\"downloadLoading\" class=\"filter-item\" type=\"primary\" icon=\"el-icon-document\" @click=\"handleDownload\">\n        导出 Excel\n      </el-button>\n    </div>\n\n    <el-table\n      :key=\"tableKey\"\n      v-loading=\"listLoading\"\n      :data=\"list\"\n      border\n      fit\n      highlight-current-row\n      style=\"width: 100%;\"\n    >\n      <el-table-column\n        v-for=\"col in tableColumns\"\n        :key=\"col.prop\"\n        :prop=\"col.prop\"\n        :label=\"col.label\"\n        :width=\"col.width\"\n        :min-width=\"col.minWidth\"\n        :align=\"col.align\"\n      >\n        <template slot-scope=\"{row}\">\n          <span v-if=\"col.type === 'status'\">{{ statusMap[row[col.prop]] }}</span>\n          <span v-else>{{ row[col.prop] }}</span>\n        </template>\n      </el-table-column>\n    </el-table>\n\n    <pagination v-show=\"total>0\" :total=\"total\" :page.sync=\"listQuery.page\" :limit.sync=\"listQuery.limit\" @pagination=\"getList\" />\n\n  </div>\n</template>\n\n<script>\nimport { fetchListManualJudgmentRedYellowOrders, exportListManualJudgmentRedYellowOrders } from '@/api/installation'\nimport waves from '@/directive/waves' // waves directive\nimport Pagination from '@/components/Pagination' // secondary package based on el-pagination\n\nexport default {\n  name: 'InstallationManualJudgmentRedYellowOrders',\n  components: { Pagination },\n  directives: { waves },\n  data() {\n    return {\n      tableKey: 0,\n      list: null,\n      total: 0,\n      listLoading: true,\n      listQuery: {\n        page: 1,\n        limit: 50,\n        county_name: undefined,\n        form_no: undefined,\n        form_title: undefined,\n        broadband_account: undefined,\n        flow_name: undefined,\n        send_time: undefined\n      },\n      filterConfig: [\n        { key: 'county_name', placeholder: '区县', type: 'input' },\n        { key: 'form_no', placeholder: '工单编号', type: 'input' },\n        { key: 'form_title', placeholder: '工单标题', type: 'input' },\n        { key: 'broadband_account', placeholder: '宽带账号', type: 'input' },\n        { key: 'flow_name', placeholder: '流程名称', type: 'multiple_select', options: [{ label: '手写判断流程', value: '手写判断流程' }, { label: '地址建设流程', value: '地址建设流程' }, { label: '分光器扩容流程', value: '分光器扩容流程' }] },\n        { key: 'send_time', start: '派单开始时间', end: '派单结束时间', type: 'date' }\n      ],\n      tableColumns: [\n        { prop: 'county_name', label: '区县', width: '110', align: 'center' },\n        { prop: 'form_no', label: '工单编号', width: '160', align: 'center' },\n        { prop: 'form_title', label: '工单标题', minWidth: '150', align: 'center' },\n        { prop: 'current_state', label: '工单状态', width: '100', align: 'center', type: 'status' },\n        { prop: 'broadband_account', label: '宽带账号', width: '120', align: 'center' },\n        { prop: 'flow_name', label: '流程名称', width: '130', align: 'center' },\n        { prop: 'send_time', label: '派单时间', width: '160', align: 'center', type: 'datetime' }\n      ],\n      statusMap: {\n        '2': '运行中',\n        '3': '已归档'\n      }\n    }\n  },\n  created() {\n    // Check for cross-page search filters in Vuex\n    const initialFilters = this.$store.state.crossPageSearch.initialFilters\n    if (initialFilters) {\n      // Merge the filters into the local query object\n      this.listQuery = { ...this.listQuery, ...initialFilters }\n      // Clear the filters in Vuex so they are not used again\n      this.$store.commit('crossPageSearch/CLEAR_INITIAL_FILTERS')\n    }\n    this.getList()\n  },\n  methods: {\n    getList() {\n      this.listLoading = true\n      fetchListManualJudgmentRedYellowOrders(this.listQuery).then(response => {\n        this.list = response.data.items\n        this.total = response.data.total\n        this.listLoading = false\n      })\n    },\n    handleFilter() {\n      this.listQuery.page = 1\n      this.getList()\n    },\n    async handleDownload() {\n      const { send_time } = this.listQuery\n      if (!send_time) {\n        this.$message.error('必须选择派单时间')\n        return\n      }\n\n      const startDate = new Date(send_time[0])\n      const endDate = new Date(send_time[1])\n      const timeDiff = endDate.getTime() - startDate.getTime()\n      const dayDiff = timeDiff / (1000 * 3600 * 24)\n\n      if (dayDiff > 40) {\n        this.$message.error('导出Excel时，期望&最后预约时间最大跨度为40天')\n        return\n      }\n\n      this.downloadLoading = true\n      try {\n        const queryForAll = { ...this.listQuery }\n        delete queryForAll.page\n        delete queryForAll.limit\n\n        const response = await exportListManualJudgmentRedYellowOrders(queryForAll)\n        const allData = response.data\n\n        if (!allData || allData.length === 0) {\n          this.$message.warning('没有可导出的数据')\n          return // Exit if there's no data to export\n        }\n\n        import('@/vendor/Export2Excel').then(excel => {\n          const tHeader = ['区县', '工单编号', '工单标题', '宽带账号', '流程名称', '派单开始时间']\n          const filterVal = ['county_name', 'form_no', 'form_title', 'broadband_account', 'flow_name', 'send_time']\n          const data = this.formatJson(filterVal, allData)\n          excel.export_json_to_excel({\n            header: tHeader,\n            data,\n            filename: `手写判断/红黄单-${new Date().toLocaleString()}`,\n            autoWidth: true,\n            bookType: 'xlsx'\n          })\n        })\n      } catch (error) {\n        console.error('导出Excel时发生错误:', error)\n        this.$message.error('导出失败，请稍后重试')\n      } finally {\n        this.downloadLoading = false\n      }\n    },\n    formatJson(filterVal, jsonData) {\n      return jsonData.map(v => filterVal.map(j => {\n        if (j === 'current_state') {\n          return this.statusMap[v[j]]\n        } else {\n          return v[j]\n        }\n      }))\n    }\n\n  }\n}\n</script>\n"]}]}